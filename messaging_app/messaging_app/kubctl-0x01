#!/bin/bash

echo "ğŸ“¦ Scaling the Django deployment to 3 replicas..."
kubectl scale deployment messaging-app-deployment --replicas=3

echo "â³ Waiting for pods to be ready..."
sleep 10

echo "ğŸ” Listing all pods..."
kubectl get pods -l app=messaging-app

echo "âš™ï¸ Running load test using wrk (10s, 2 threads, 10 connections)..."
# Replace <service-ip> and <port> with actual values from 'minikube service' or port-forward
wrk http://localhost:8000 --duration 10s --threads 2 --connections 10

echo "ğŸ“Š Monitoring resource usage..."
kubectl top pods